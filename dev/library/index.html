<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · Easy access to FITS files in Julia</title><meta name="title" content="Reference · Easy access to FITS files in Julia"/><meta property="og:title" content="Reference · Easy access to FITS files in Julia"/><meta property="twitter:title" content="Reference · Easy access to FITS files in Julia"/><meta name="description" content="Documentation for Easy access to FITS files in Julia."/><meta property="og:description" content="Documentation for Easy access to FITS files in Julia."/><meta property="twitter:description" content="Documentation for Easy access to FITS files in Julia."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Easy access to FITS files in Julia</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../structure/">Structure of FITS files</a></li><li><a class="tocitem" href="../reading/">Reading FITS files</a></li><li><a class="tocitem" href="../writing/">Writing FITS files</a></li><li><a class="tocitem" href="../files/">Navigating in FITS files</a></li><li><a class="tocitem" href="../images/">FITS Image HDUs</a></li><li><a class="tocitem" href="../tables/">FITS Table HDUs</a></li><li class="is-active"><a class="tocitem" href>Reference</a><ul class="internal"><li><a class="tocitem" href="#Types"><span>Types</span></a></li><li><a class="tocitem" href="#Aliases"><span>Aliases</span></a></li><li><a class="tocitem" href="#Direct-reading/writing-of-FITS-files"><span>Direct reading/writing of FITS files</span></a></li><li><a class="tocitem" href="#FITS-files"><span>FITS files</span></a></li><li><a class="tocitem" href="#FITS-image-HDUs"><span>FITS image HDUs</span></a></li><li><a class="tocitem" href="#FITS-table-HDUs"><span>FITS table HDUs</span></a></li><li><a class="tocitem" href="#FITS-header"><span>FITS header</span></a></li><li><a class="tocitem" href="#FITS-Header-Data-Units-(HDUs)"><span>FITS Header Data Units (HDUs)</span></a></li><li><a class="tocitem" href="#Utilities"><span>Utilities</span></a></li></ul></li><li><a class="tocitem" href="../links/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/emmt/EasyFITS.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/emmt/EasyFITS.jl/blob/master/docs/src/library.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h1><h2 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EasyFITS.FitsHDU" href="#EasyFITS.FitsHDU"><code>EasyFITS.FitsHDU</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FitsHDU</code></pre><p>is the abstract type of FITS Header Data Units which consists in a header and a data parts. Concrete instances of <code>FitsHDU</code> behave as vectors whose elements are FITS header records, a.k.a. FITS cards, and which can be indexed by integers or by names.</p><p>For faster access to the records of a header, consider creating a FITS header object from a HDU object:</p><pre><code class="nohighlight hljs">hdr = FitsHeader(hdu::FitsHDU)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/types.jl#L261-L273">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EasyFITS.FitsError" href="#EasyFITS.FitsError"><code>EasyFITS.FitsError</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FitsError &lt;: Exception</code></pre><p>is the type of exceptions thrown when an error occurs in the FITSIO library used to manage FITS files.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/types.jl#L350-L356">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EasyFITS.FitsLogic" href="#EasyFITS.FitsLogic"><code>EasyFITS.FitsLogic</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FitsLogic()</code></pre><p>yields a singleton object to indicate that FITS rules should be applied for some logical operation. For example:</p><pre><code class="nohighlight hljs">isequal(FitsLogic(), s1, s2)</code></pre><p>compares strings <code>s1</code> and <code>s2</code> according to FITS rules, that is case of letters and trailing spaces are irrelevant.</p><pre><code class="nohighlight hljs">isequal(FitsLogic(), x) -&gt; f</code></pre><p>yields a predicate function <code>f</code> such that <code>f(y)</code> yields <code>isequal(FitsLogic(),x,y)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/types.jl#L330-L345">source</a></section></article><h2 id="Aliases"><a class="docs-heading-anchor" href="#Aliases">Aliases</a><a id="Aliases-1"></a><a class="docs-heading-anchor-permalink" href="#Aliases" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EasyFITS.Header" href="#EasyFITS.Header"><code>EasyFITS.Header</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EasyFITS.Header</code></pre><p>is the (union of) type(s) that are accepted to specify a FITS header in <code>EasyFITS</code> package.</p><p>A header may be a vector of pairs like <code>key =&gt; val</code>, <code>key =&gt; (val,com)</code>, or <code>key =&gt; com</code> with <code>key</code> the keyword name, <code>val</code> its value, and <code>com</code> its comment. The keyword name <code>key</code> is a string or a symbol which is automatically converted to uppercase letters and trailing spaces discarded. The syntax <code>key =&gt; com</code>, with <code>com</code> a string, is only allowed for commentary keywords <code>COMMENT</code> or <code>HISTORY</code>. For other keywords, the value is mandatory but the comment is optional, not specifying the comment is like specifying <code>nothing</code> for the comment; otherwise, the comment must be a string. The value <code>val</code> may be <code>missing</code> or <code>undef</code> to indicate that it is undefined. If the comment is too long, it is automatically split across multiple records for commentary keywords and it is truncated for other keywords. A non-commentary keyword may have units specified in square brackets at the beginning of the associated comment. Commentary keywords may appear more than once, other keywords are unique.</p><p>For example:</p><pre><code class="nohighlight hljs">[&quot;VERIFIED&quot; =&gt; true,
 &quot;COUNT&quot; =&gt; (42, &quot;Fundamental number&quot;),
 &quot;SPEED&quot; =&gt; (2.1, &quot;[km/s] Speed of gizmo&quot;),
 &quot;USER&quot; =&gt; &quot;Julia&quot;,
 &quot;AGE&quot; =&gt; (undef, &quot;Some undefined value.&quot;),
 &quot;JOB&quot; =&gt; (missing, &quot;Another undefined value.&quot;),
 &quot;HISTORY&quot; =&gt; &quot;Some historical information.&quot;,
 &quot;COMMENT&quot; =&gt; &quot;Some comment.&quot;,
 &quot;COMMENT&quot; =&gt; &quot;Some other comment.&quot;,
 &quot;HISTORY&quot; =&gt; &quot;Some other historical information.&quot;]</code></pre><p>defines a possible FITS header with several records: a keyword <code>VERIFIED</code> having a logical value and no comments, a keyword <code>COUNT</code> having an integer value and a comment, a keyword <code>SPEED</code> having a floating-point value and a comment with units, a keyword <code>USER</code> having a string value, keywords <code>AGE</code> and <code>JOB</code> having comments but undefined values, and a few additional commentary keywords.</p><p>A header may also be specified as a named tuple with entries <code>key = val</code>, <code>key = (val,com)</code>, or <code>key = com</code>. The same rules apply as above except that <code>key</code> must be allowed as a variable symbolic name (no embedded hyphen <code>&#39;-&#39;</code>).</p><p>Finally, most methods assume that <code>nothing</code> can be used to indicate an empty header.</p><div class="admonition is-info" id="Note-8d828cedf293bd3f"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-8d828cedf293bd3f" title="Permalink"></a></header><div class="admonition-body"><p>Specifying a FITS header as a dictionary is purposely not implemented because, to a certain extend, the order of keywords in a FITS header is relevant and because some keywords (<code>COMMENT</code>, <code>HISTORY</code>, and <code>CONTINUE</code>) may appear more than once.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/types.jl#L19-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EasyFITS.TableData" href="#EasyFITS.TableData"><code>EasyFITS.TableData</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EasyFITS.TableData</code></pre><p>is the union of types that can possibly be that of FITS table data. Instances of this kind are collections of <code>key =&gt; vals</code> or <code>key =&gt; (vals, units)</code> pairs with <code>key</code> the column name, <code>vals</code> the column values, and <code>units</code> the optional units of these values. Such collections can be dictionaries, named tuples, vectors, or tuples.</p><p>For table data specified by dictionaries or vectors, the names of the columns must all be of the same type.</p><p>Owing to the variety of possibilities for representing column values with optional units, <code>EasyFITS.TableData</code> cannot be specific for the values of the pairs in the collection. The package therefore rely on <em>error catcher</em> methods to detect column with invalid associated data.</p><p>Another consequence is that there is a non-empty intersection between <code>EasyFITS.TableData</code> and <code>EasyFITS.Header</code> which imposes to rely on position of arguments to distinguish them.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/types.jl#L236-L255">source</a></section></article><h2 id="Direct-reading/writing-of-FITS-files"><a class="docs-heading-anchor" href="#Direct-reading/writing-of-FITS-files">Direct reading/writing of FITS files</a><a id="Direct-reading/writing-of-FITS-files-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-reading/writing-of-FITS-files" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EasyFITS.readfits" href="#EasyFITS.readfits"><code>EasyFITS.readfits</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">readfits(FitsHeader, filename; ext=1, kwds...) -&gt; hdr::FitsHeader
read(FitsHeader, filename; ext=1, kwds...) -&gt; hdr::FitsHeader
read(filename, FitsHeader; ext=1, kwds...) -&gt; hdr::FitsHeader</code></pre><p>Read the header of the <code>ext</code> extension of the FITS file <code>filename</code>. See <a href="#EasyFITS.FitsFile"><code>FitsFile</code></a> for the possible keywords <code>kwds...</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L122-L130">source</a></section><section><div><pre><code class="language-julia hljs">readfits([R::Type,] filename, args...; ext=1, extended=false, kwds...) -&gt; data</code></pre><p>reads some data in extension <code>ext</code> (a Header Data Unit number or a name) in FITS file <code>filename</code>. Specify keyword <code>extended = true</code> to use CFITSIO extended filename syntax.</p><p>If <code>R</code> is specified, the data is returned as an object of type <code>R</code>. Array type parameters may be specified in <code>R</code>. For example, specify <code>R = Array{Float32}</code> to ensure that the result be a single precision floating-point array.</p><p>If the extension is an image, <code>args...</code> specifies the ranges of pixels to read along the dimensions. The default is to read all pixels.</p><p>If the extension is a table, <code>args...</code> consist in up to 2 arguments <code>cols</code> and <code>rows</code> to select a subset of columns and of rows respectively. The default is to read all columns and rows.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L144-L161">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EasyFITS.readfits!" href="#EasyFITS.readfits!"><code>EasyFITS.readfits!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">readfits!(dest, filename, args...; kwds...) -&gt; dest</code></pre><p>overwrites destination <code>dest</code> with some data read from FITS file named <code>filename</code>. This is more efficient but is similar to:</p><pre><code class="nohighlight hljs">copyto!(dest, readfits(typeof(dest), filename, args...; kwds...))</code></pre><p>See <a href="#EasyFITS.readfits"><code>readfits</code></a> for the meaning of arguments and for possible keywords.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L176-L186">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EasyFITS.writefits" href="#EasyFITS.writefits"><code>EasyFITS.writefits</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">writefits(filename, hdr, dat, args...; overwrite = false, kwds...)</code></pre><p>creates a new FITS file named <code>filename</code> whose contents is specified by <code>hdr</code>, <code>dat</code>, and <code>args...</code>. If the file already exists, the method fails unless keyword <code>overwrite</code> is <code>true</code>. See <a href="#EasyFITS.FitsFile"><code>FitsFile</code></a> for other keywords that may be specified when opening the file.</p><p>Arguments <code>hdr</code> and <code>dat</code> are the header and the data of a 1st Header Data Unit (HDU) to write. Trailing arguments <code>args...</code> are headers and data of optional additional HDUs.</p><p>See also <a href="#EasyFITS.writefits!"><code>writefits!</code></a> and <a href="#EasyFITS.FitsFile"><code>FitsFile</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L196-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EasyFITS.writefits!" href="#EasyFITS.writefits!"><code>EasyFITS.writefits!</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">writefits!(filename, args...; kwds...)</code></pre><p>creates a new FITS file named <code>filename</code> whose contents is specified by <code>args...</code>. If the file already exists, it is (silently) overwritten. This method is equivalent to:</p><pre><code class="nohighlight hljs">writefits(filename, args...; overwrite = true, kwds...)</code></pre><p>See <a href="#EasyFITS.writefits"><code>writefits</code></a> for the meaning of <code>args...</code> and <a href="#EasyFITS.FitsFile"><code>FitsFile</code></a> for other keywords that may be specified when opening the file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L218-L229">source</a></section></article><h2 id="FITS-files"><a class="docs-heading-anchor" href="#FITS-files">FITS files</a><a id="FITS-files-1"></a><a class="docs-heading-anchor-permalink" href="#FITS-files" title="Permalink"></a></h2><p>Missing <code>EasyFITS.write!</code>, <code>read(::FitsFile, ...)</code>, <code>read!(::DenseArray{&lt;:Number},::FitsImageHDU,::SubArrayIndex...)</code> <code>read!(::DenseArray{&lt;:Number},::FitsImageHDU)</code></p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EasyFITS.FitsFile" href="#EasyFITS.FitsFile"><code>EasyFITS.FitsFile</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">file = FitsFile(filename, mode=&quot;r&quot;; extended=false)</code></pre><p>Open FITS file <code>filename</code> for reading if <code>mode</code> is <code>&quot;r&quot;</code>, for reading and writing if mode is &quot;rw&quot;, or create a new file if mode is <code>&quot;w&quot;</code> or <code>&quot;w!&quot;</code>.</p><p>File must not exists if mode is <code>&quot;w&quot;</code>. File is overwritten if it exists and mode is <code>&quot;w!&quot;</code>. The file is automatically closed when the <code>file</code> object is finalized, i.e.. no needs to call <code>close(file)</code>.</p><p>Keyword <code>extended</code> specifies whether to use extended file name syntax featured by the CFITSIO library.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L3-L16">source</a></section><section><div><pre><code class="language-julia hljs">FitsFile(func::Function, filename, mode=&quot;r&quot;; kwds...)</code></pre><p>Execute <code>func(file)</code> with <code>file</code> the FITS file <code>filename</code> open for <code>mode</code> access and close <code>file</code> even though <code>func</code> may throw an exception. This is typically used with the <code>do</code>-block syntax:</p><pre><code class="nohighlight hljs">FitsFile(filename, mode=&quot;r&quot;; kwds...) do file
    ... # use file
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L90-L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.pathof-Tuple{FitsFile}" href="#Base.pathof-Tuple{FitsFile}"><code>Base.pathof</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pathof(file::FitsFile) -&gt; filename</code></pre><p>Return the name of the FITS file associated with <code>file</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L256-L261">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.Filesystem.filemode-Tuple{FitsFile}" href="#Base.Filesystem.filemode-Tuple{FitsFile}"><code>Base.Filesystem.filemode</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">filemode(file::FitsFile)</code></pre><p>Return <code>:r</code>, <code>:rw</code>, or <code>:w</code> depending whether <code>file</code> is open for reading only, reading and writing, or writing.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L264-L270">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.isreadonly-Tuple{FitsFile}" href="#Base.isreadonly-Tuple{FitsFile}"><code>Base.isreadonly</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isreadonly(file::FitsFile)</code></pre><p>Return whether <code>file</code> is read-only.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L281-L286">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.iswritable-Tuple{FitsFile}" href="#Base.iswritable-Tuple{FitsFile}"><code>Base.iswritable</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">iswritable(file::FitsFile)</code></pre><p>Return whether <code>file</code> is writable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L289-L294">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.seek-Tuple{FitsFile, Integer}" href="#Base.seek-Tuple{FitsFile, Integer}"><code>Base.seek</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">seek(file::FitsFile, n) -&gt; type</code></pre><p>moves to <code>n</code>-th HDU of FITS file <code>file</code> and returns an integer identifying the type of the HDU:</p><ul><li><p><code>FITS_IMAGE_HDU</code> if the <code>n</code>-th HDU contains an image.</p></li><li><p><code>FITS_BINARY_TABLE_HDU</code> if the <code>n</code>-th HDU contains a binary table.</p></li><li><p><code>FITS_ASCII_TABLE_HDU</code> if the <code>n</code>-th HDU contains an ASCII table.</p></li><li><p><code>FITS_ANY_HDU</code> if the <code>n</code>-th HDU is undefined.</p></li></ul><p>An error is thrown if the file has been closed.</p><p>See also <a href="#Base.seekstart-Tuple{FitsFile}"><code>seekstart(::FitsFile)</code></a>, <a href="#Base.seekend-Tuple{FitsFile}"><code>seekend(::FitsFile)</code></a>, and <a href="#Base.position-Tuple{FitsFile}"><code>position(::FitsFile)</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L297-L316">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.seekstart-Tuple{FitsFile}" href="#Base.seekstart-Tuple{FitsFile}"><code>Base.seekstart</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">seekstart(file::FitsFile) -&gt; type</code></pre><p>moves to the first HDU of FITS file <code>file</code> and returns an integer identifying the type of the HDU.</p><p>See also <a href="#Base.seek-Tuple{FitsFile, Integer}"><code>seek(::FitsFile)</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L323-L331">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.seekend-Tuple{FitsFile}" href="#Base.seekend-Tuple{FitsFile}"><code>Base.seekend</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">seekend(file::FitsFile) -&gt; type</code></pre><p>moves to the last HDU of FITS file <code>file</code> and returns an integer identifying the type of the HDU.</p><p>See also <a href="#Base.seek-Tuple{FitsFile, Integer}"><code>seek(::FitsFile)</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L334-L342">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.position-Tuple{FitsFile}" href="#Base.position-Tuple{FitsFile}"><code>Base.position</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">position(file::FitsFile) -&gt; n</code></pre><p>yields the current HDU number of FITS file <code>file</code>. An error is thrown if the file has been closed.</p><p>See also <a href="#Base.seek-Tuple{FitsFile, Integer}"><code>seek(::FitsFile)</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L345-L353">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.flush-Tuple{FitsFile}" href="#Base.flush-Tuple{FitsFile}"><code>Base.flush</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">flush(f::Union{FitsFile,FitsHDU})</code></pre><p>flushes the internal data buffers of <code>f</code> to the associated output FITS file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L359-L364">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.eachmatch-Tuple{Any, FitsFile}" href="#Base.eachmatch-Tuple{Any, FitsFile}"><code>Base.eachmatch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eachmatch(pat, file::FitsFile)</code></pre><p>yields an iterator over the Header Data Units (HDUs) of FITS <code>file</code> matching pattern <code>pat</code>. Pattern <code>pat</code> can be a string or a regular expression to be matched against the name of the HDUs of <code>file</code> or a predicate function taking a HDU as argument and returning whether it matches.</p><p>For example:</p><pre><code class="nohighlight hljs">for hdu in eachmatch(pat, file)
    ... # do something
end</code></pre><p>is a shortcut for:</p><pre><code class="nohighlight hljs">i = findfirst(pat, file)
while i !== nothing
    hdu = file[i]
    ... # do something
    i = findnext(pat, file, i+1)
end</code></pre><p>while:</p><pre><code class="nohighlight hljs">for hdu in reverse(eachmatch(pat, file))
    ... # do something
end</code></pre><p>is equivalent to:</p><pre><code class="nohighlight hljs">i = findlast(pat, file)
while i !== nothing
    hdu = file[i]
    ... # do something
    i = findprev(pat, file, i-1)
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L559-L597">source</a></section></article><h2 id="FITS-image-HDUs"><a class="docs-heading-anchor" href="#FITS-image-HDUs">FITS image HDUs</a><a id="FITS-image-HDUs-1"></a><a class="docs-heading-anchor-permalink" href="#FITS-image-HDUs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EasyFITS.FitsImageHDU" href="#EasyFITS.FitsImageHDU"><code>EasyFITS.FitsImageHDU</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hdu = FitsImageHDU(file::FitsFile, dims...; bitpix=...)
hdu = FitsImageHDU{T}(file::FitsFile, dims...)
hdu = FitsImageHDU{T,N}(file::FitsFile, dims...)</code></pre><p>create a new primary array or image extension in FITS file <code>file</code> with a specified pixel type <code>T</code> and size <code>dims...</code>. If the FITS file is currently empty then a primary array is created, otherwise a new image extension is appended to the file. Pixel type can be specified as a numeric type <code>T</code> or as an integer BITPIX code <code>bitpix</code>.</p><p>An object to manage the new extension is returned which can be used to push header cards and then to write the data.</p><p>If the array to be written is available, the element type and dimensions can be inferred from the array itself:</p><pre><code class="nohighlight hljs">hdu = FitsImageHDU{T=eltype(arr),N=ndims(arr)}(file::FitsFile, arr::AbstractArray)</code></pre><p>For example:</p><pre><code class="nohighlight hljs">hdu = FitsImageHDU(file, arr)
hdu[&quot;KEY1&quot;] = val1             # add a 1st header record
hdu[&quot;KEY2&quot;] = (val2, str2)     # add a 2nd header record
hdu[&quot;KEY3&quot;] = (nothing, str3)  # add a 3rd header record
write(hdu, arr)                # write data</code></pre><p>will create a new Header Data Unit (HDU) storing array <code>arr</code> with 3 additional header records: one named <code>&quot;KEY1&quot;</code> with value <code>val1</code> and no comments, another named <code>&quot;KEY2&quot;</code> with value <code>val2</code> and comment string <code>str2</code>, and yet another one named <code>&quot;KEY3&quot;</code> with no value and with comment string <code>str3</code>. Note that special names <code>&quot;COMMENT&quot;</code>, <code>&quot;HISTORY&quot;</code>, and <code>&quot;&quot;</code> indicating commentary entries have no associated, only a comment string, say <code>str</code> which can be specified as <code>str</code> or as <code>(nothing,str)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/images.jl#L238-L271">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.read-Tuple{FitsImageHDU}" href="#Base.read-Tuple{FitsImageHDU}"><code>Base.read</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read(R::Type = Array, hdu::FitsImageHDU[, inds...]) -&gt; arr::R</code></pre><p>reads the FITS image data in <code>hdu</code> or the rectangular sub-region defined by the indices <code>inds...</code> if specified.</p><p>Optional argument <code>R</code> is to restrict the ouput type and improve type-stability. For example:</p><pre><code class="nohighlight hljs">arr = convert(Array{Float32}, read(hdu))
arr = read(Array{Float32}, hdu)
arr = read(Array{Float32,3}, hdu)</code></pre><p>yield similar results if <code>hdu</code> is a 3-dimensional image extension but the 2nd example is more efficient than the 1st one as no temporary array is needed if the pixel type is not equivalent to <code>Float32</code> and the 3rd example is completely type-stable.</p><p>Keywords <code>anynull</code> and <code>null</code> may be specified to deal with undefined pixel values (see documentation for <a href="#Base.read!-Tuple{Array, FitsImageHDU}"><code>read!</code></a>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/images.jl#L40-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.read!-Tuple{Array, FitsImageHDU}" href="#Base.read!-Tuple{Array, FitsImageHDU}"><code>Base.read!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read!(arr::DenseArray{&lt;:Number}, hdu::FitsImageHDU[, inds...]) -&gt; arr</code></pre><p>overwrites all the elements of the array <code>arr</code> with pixel values read from the FITS image data in <code>hdu</code> and returns <code>arr</code>. Pixel values are converted to the element type of <code>arr</code>.</p><p>If <code>inds...</code> are specified, only the rectangular sub-region defined by <code>inds...</code> is read and the destination array must have the same dimensions as this region (the same rules as for sub-indexing an array are applied to determine the dimensions of the sub-region).</p><p>If <code>inds...</code> are not specified, the complete image is read unless another value than <code>nothing</code> (the default) is given to the keywords <code>first</code> and/or <code>last</code>:</p><ul><li><p>To read a rectangular sub-image, set keywords <code>first</code> and <code>last</code> with <code>N</code>-tuple of integers indicating the coordinates of the first and last pixels to read. Optionally, keyword <code>step</code> may be set to an <code>N</code>-tuple of integers to indicate the increment along each dimensions. Increments must be positive. Here <code>N</code> is the number of dimensions of the FITS image extension.</p></li><li><p>To read consecutive pixels, specify at least one of the keywords <code>first</code> and/or <code>last</code> with an integer indicating the index of the first and/or last pixels to read.</p></li></ul><p>When at least one of the keywords <code>first</code> and/or <code>last</code> is not <code>nothing</code>, the dimensions of the destination <code>arr</code> are not considered. In any case, the number of elements of <code>arr</code> must be equal to the number of pixels to read.</p><p>Keyword <code>anynull</code> may be specified with a reference to a boolean (<code>Ref{Bool}()</code>) to retrieve whether any of the read pixels is undefined.</p><p>Keyword <code>null</code> may be specified with a reference to a value of the same type as the elements of the destination <code>arr</code> (<code>Ref{eltype(arr)}()</code>) to retrieve the value of undefined pixels. Unless reading a rectangular sub-image, keyword <code>null</code> may be set with an array of <code>Bool</code> of same size as <code>arr</code> and which will be set to <code>true</code> for undefined pixels and to <code>false</code> elsewhere.</p><p>Output arrays <code>arr</code> and <code>null</code> must have contiguous elements, in other words, they must be <em>dense arrays</em>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/images.jl#L108-L146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.write-Tuple{FitsImageHDU, Array}" href="#Base.write-Tuple{FitsImageHDU, Array}"><code>Base.write</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">write(hdu::FitsImageHDU, arr::AbstractArray{&lt;:Number}) -&gt; hdu</code></pre><p>writes all the elements of the array <code>arr</code> to the pixels of the FITS image extension of the header data unit <code>hdu</code>. The element of <code>arr</code> are converted to the type of the pixels. The default is to write the complete image pixels, so the size of the destination <code>arr</code> must be identical to the dimensions of the FITS image extension. This behavior may be changed by specifying another value than <code>nothing</code> for the keywords <code>first</code> and/or <code>last</code>:</p><ul><li><p>To write a rectangular sub-image, specify keywords <code>first</code> and <code>last</code> with the coordinates of the first and last pixels to write as an <code>N</code>-tuple of integers, with <code>N</code> the number of dimensions of the FITS image extension.</p></li><li><p>To write consecutive pixels, specify at least one of the keywords <code>first</code> and/or <code>last</code> with the index of the first and/or last pixels to write as an integer.</p></li></ul><p>When at least one of the keywords <code>first</code> and/or <code>last</code> is not <code>nothing</code>, the dimensions of <code>arr</code> are not considered. In any case, the number of elements of <code>arr</code> must be equal to the number of pixels to write.</p><p>Unless writing a rectangular sub-image, keyword <code>null</code> may be used to specify the value of undefined elements in <code>arr</code>. For integer FITS images, the FITS null value is defined by the <code>BLANK</code> keyword (an error is returned if the BLANK keyword doesn&#39;t exist). For floating point FITS images the special IEEE NaN (Not-a-Number) value will be written into the FITS file.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/images.jl#L356-L382">source</a></section></article><h2 id="FITS-table-HDUs"><a class="docs-heading-anchor" href="#FITS-table-HDUs">FITS table HDUs</a><a id="FITS-table-HDUs-1"></a><a class="docs-heading-anchor-permalink" href="#FITS-table-HDUs" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EasyFITS.FitsTableHDU" href="#EasyFITS.FitsTableHDU"><code>EasyFITS.FitsTableHDU</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hdu = FitsTableHDU(file, cols...)</code></pre><p>creates a new FITS table extension in FITS file <code>file</code> with columns defined by <code>cols...</code>. Each column definition is a pair <code>name =&gt; format</code> where <code>name</code> is the column name while <code>format</code> specifies the type of the column values and, optionally, their units and the size of the column cells. The following definitions are possible:</p><pre><code class="nohighlight hljs">name =&gt; type
name =&gt; (type,)
name =&gt; (type, units)
name =&gt; (type, dims)
name =&gt; (type, units, dims)
name =&gt; (type, dims, units)</code></pre><p>where <code>type</code> is either a Julia type (<code>Number</code> or <code>String</code>) or a letter (see table below), <code>dims</code> is an integer or a tuple of integers, and <code>units</code> is a string. By default, <code>dims = (1,)</code> and <code>units = &quot;&quot;</code>.</p><table><tr><th style="text-align: left">Type</th><th style="text-align: left">Letter</th><th style="text-align: left">Remarks</th></tr><tr><td style="text-align: left"><code>AbstractString</code></td><td style="text-align: left"><code>&#39;A&#39;</code></td><td style="text-align: left">ASCII string</td></tr><tr><td style="text-align: left"><code>Bool</code></td><td style="text-align: left"><code>&#39;L&#39;</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>Int8</code></td><td style="text-align: left"><code>&#39;S&#39;</code></td><td style="text-align: left">CFITSIO specific</td></tr><tr><td style="text-align: left"><code>UInt8</code></td><td style="text-align: left"><code>&#39;B&#39;</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>Int16</code></td><td style="text-align: left"><code>&#39;I&#39;</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>UInt16</code></td><td style="text-align: left"><code>&#39;U&#39;</code></td><td style="text-align: left">CFITSIO specific</td></tr><tr><td style="text-align: left"><code>Int32</code></td><td style="text-align: left"><code>&#39;J&#39;</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>UInt32</code></td><td style="text-align: left"><code>&#39;V&#39;</code></td><td style="text-align: left">CFITSIO specific</td></tr><tr><td style="text-align: left"><code>Int64</code></td><td style="text-align: left"><code>&#39;K&#39;</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>UInt64</code></td><td style="text-align: left"><code>&#39;W&#39;</code></td><td style="text-align: left">CFITSIO specific</td></tr><tr><td style="text-align: left"><code>Float32</code></td><td style="text-align: left"><code>&#39;E&#39;</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>Float64</code></td><td style="text-align: left"><code>&#39;D&#39;</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>Complex{Float32}</code></td><td style="text-align: left"><code>&#39;C&#39;</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>Complex{Float64}</code></td><td style="text-align: left"><code>&#39;M&#39;</code></td><td style="text-align: left"></td></tr><tr><td style="text-align: left"><code>FitsBit</code></td><td style="text-align: left"><code>&#39;X&#39;</code></td><td style="text-align: left">bits</td></tr></table><p>The returned object can be used to add FITS keywords to the header of the table and, then, to write column data. Typically:</p><pre><code class="nohighlight hljs">hdu = FitsTableHDU(file, cols)
push!(hdu, key1 =&gt; val1) # add a first header keyword
...                      # add other header keywords
write(hdu, col1 =&gt; arr1) # write a first column
...                      # write other columns</code></pre><p>where <code>key1 =&gt; val1</code>, <code>key2 =&gt; val2</code>, etc. specify header cards, while <code>col1 =&gt; arr1</code>, <code>col2 =&gt; arr2</code>, etc. specify columns names and associated data. Such a table may be created in a single call:</p><pre><code class="nohighlight hljs">write(file, [key1 =&gt; val1, key2 =&gt; val2, ...], [col1 =&gt; arr1, col2 =&gt; arr2, ...])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/tables.jl#L682-L734">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.read-Tuple{FitsTableHDU}" href="#Base.read-Tuple{FitsTableHDU}"><code>Base.read</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read([Dict,] hdu::FitsTableHDU[, cols[, rows]]) -&gt; dict</code></pre><p>reads several columns of the FITS table extension in <code>hdu</code> as a dictionary indexed by the column names. The columns to read can be specified by <code>cols</code> which may be a single column name/index, a tuple/range/vector of column names/numbers, or a colon <code>:</code> to read all columns (the default). Column names may be strings or symbols (not a mixture of these). The rows to read can be specified by <code>rows</code> as a single row index, a unit range of row numbers, or a colon <code>:</code> to read all rows (the default).</p><p>Keyword <code>rename</code> is to specify a function to change column names. If unspecified, the column names are left unchanged if keyword <code>case</code> is true and converted to uppercase letters otherwise.</p><p>Keyword <code>units</code> can be used to indicate whether to retrieve the units of the columns. If <code>units</code> is <code>String</code>, the values of the dictionary will be 2-tuples <code>(data,units)</code> with <code>data</code> the column data and <code>units</code> the column units as a string. Otherwise, if <code>units</code> is <code>nothing</code> (the default), the values of the dictionary will just be the columns data.</p><p>To avoid the <code>units</code> keyword, the following methods are provided:</p><pre><code class="nohighlight hljs">read(Dict{String,Array},               hdu[, cols[, rows]])
read(Dict{String,Tuple{Array,String}}, hdu[, cols[, rows]])</code></pre><p>to yield the same result as <code>read(hdu,...)</code> with respectively <code>units=nothing</code> and <code>units=String</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/tables.jl#L459-L486">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.read-Tuple{Type{Vector{T} where T}, FitsTableHDU}" href="#Base.read-Tuple{Type{Vector{T} where T}, FitsTableHDU}"><code>Base.read</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read(Vector, hdu::FitsTableHDU[, cols[, rows]]) -&gt; vec::Vector</code></pre><p>reads some columns of the FITS table extension in <code>hdu</code> as a vector. The columns to read can be specified by <code>cols</code> which may be a single column name/index, a tuple/range/vector of column names/numbers, or a colon <code>:</code> to read all columns (the default). Column names may be strings or symbols (not a mixture of these). The rows to read can be specified by <code>rows</code> as a single row index, a unit range of row numbers, or a colon <code>:</code> to read all rows (the default). <code>V</code> is the type of the result.</p><p>Keyword <code>units</code> can be used to indicate whether to retrieve the units of the columns. If <code>units</code> is <code>String</code>, the elements of the result will be 2-tuples <code>(data,units)</code> with <code>data</code> the column data and <code>units</code> the column units as a string. Otherwise, if <code>units=nothing</code> (the default), the elements of the result will just be the columns data.</p><p>To avoid the <code>units</code> keyword and allow more control on the type of the result, the following 2 methods are provided:</p><pre><code class="nohighlight hljs">read(Vector{&lt;:Array},               hdu[, cols[, rows]])
read(Vector{Tuple{&lt;:Array,String}}, hdu[, cols[, rows]])</code></pre><p>to yield the same result as <code>read(hdu,...)</code> with respectively <code>units=nothing</code> and <code>units=String</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/tables.jl#L543-L567">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.read-Tuple{FitsTableHDU, String}" href="#Base.read-Tuple{FitsTableHDU, String}"><code>Base.read</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read([R=Array,] hdu::FitsTableHDU, col[, rows]; kwds...) -&gt; vals::R</code></pre><p>reads a single column <code>col</code> of the FITS table extension in <code>hdu</code> and returns its values and, possibly, its units.</p><p>The column <code>col</code> may be specified by its name or by its number. If <code>col</code> is a string or a symbol, keyword <code>case</code> specifies whether the case of letters matters (<code>case = false</code> by default).</p><p>Optional leading argument <code>R</code> is to specify the type of the result which can be an array type, to only retrieve the column values, or a tuple of array and string types, to retrieve the column values and their units.</p><p>Optional argument <code>rows</code> is to specify which rows to read. It can be an integer to read a single row, a unit range of integers to read these rows, or a colon <code>:</code> to read all rows (the default). Use <code>hdu.first_row</code> and <code>hdu.last_row</code> to retrieve the first and last row numbers.</p><p>See <a href="#Base.read!-Tuple{Array, FitsTableHDU, String}"><code>read!</code></a> for the other possible keywords.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/tables.jl#L184-L205">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.read!-Tuple{Dict, FitsTableHDU}" href="#Base.read!-Tuple{Dict, FitsTableHDU}"><code>Base.read!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read!(dict, hdu::FitsTableHDU[, cols[, rows]]) -&gt; dict</code></pre><p>merges the contents of the dictionary <code>dict</code> with the column(s) <code>cols</code> read from the FITS table extension in <code>hdu</code> and returns the dictionary.</p><p>Previous contents of <code>dict</code> is not erased, call <code>read!(empty!(dict),hdu,...)</code> to erase any contents prior to reading.</p><p>The <code>case</code> keyword specify whether to consider the case of characters in column names. By default, <code>case = false</code>.</p><p>The <code>rename</code> keyword may be specified with a function that converts the column names into dictionary keys. If unspecified, the default is to convert column names to uppercase characters if keyword <code>case</code> is <code>false</code> and to leave column names unchanged otherwise.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/tables.jl#L511-L527">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.read!-Tuple{Array, FitsTableHDU, String}" href="#Base.read!-Tuple{Array, FitsTableHDU, String}"><code>Base.read!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">read!(arr::DenseArray, hdu::FitsTableHDU, col) -&gt; arr</code></pre><p>overwrites the elements of array <code>arr</code> with values of the column <code>col</code> of the FITS table extension in <code>hdu</code> and returns <code>arr</code>.</p><p>The column <code>col</code> may be specified by its name or by its number. If <code>col</code> is a string or a symbol, keyword <code>case</code> indicates whether the case of letters matters (<code>case = false</code> by default).</p><p>Keyword <code>first</code> may be specified with the index of the first row to read. By default, <code>first = hdu.first_row</code> and reading starts at the first row of the table.</p><p>Keyword <code>anynull</code> may be specified with a reference to a boolean (<code>Ref{Bool}()</code>) to retrieve whether any of the read values is undefined.</p><p>Keyword <code>null</code> may be specified with a reference to a value of the same type as the elements of the destination <code>arr</code> (<code>Ref{eltype(arr)}()</code>) to retrieve the value of undefined values. Keyword <code>null</code> may also be set with an array of <code>Bool</code> of same size as <code>arr</code> and which will be set to <code>true</code> for undefined values and to <code>false</code> elsewhere.</p><p>Output arrays <code>arr</code> and <code>null</code> must have contiguous elements, in other words, they must be <em>dense arrays</em>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/tables.jl#L595-L619">source</a></section></article><h2 id="FITS-header"><a class="docs-heading-anchor" href="#FITS-header">FITS header</a><a id="FITS-header-1"></a><a class="docs-heading-anchor-permalink" href="#FITS-header" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FITSHeaders.Headers.FitsHeader-Tuple{FitsHDU}" href="#FITSHeaders.Headers.FitsHeader-Tuple{FitsHDU}"><code>FITSHeaders.Headers.FitsHeader</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">FitsHeader(hdu::FitsHDU)</code></pre><p>reads all records of the header of <code>hdu</code> and returns an efficient object representing them.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/hdus.jl#L193-L198">source</a></section></article><h2 id="FITS-Header-Data-Units-(HDUs)"><a class="docs-heading-anchor" href="#FITS-Header-Data-Units-(HDUs)">FITS Header Data Units (HDUs)</a><a id="FITS-Header-Data-Units-(HDUs)-1"></a><a class="docs-heading-anchor-permalink" href="#FITS-Header-Data-Units-(HDUs)" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Base.nameof-Tuple{FitsHDU}" href="#Base.nameof-Tuple{FitsHDU}"><code>Base.nameof</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nameof(hdu::FitsHDU) -&gt; str</code></pre><p>yields the name of the FITS header data unit <code>hdu</code>. The result is the value of the first keyword of <code>&quot;EXTNAME&quot;</code> or <code>&quot;HDUNAME&quot;</code> which exists and has a string value. If none of these keywords exist, the result is <code>hdu.xtension</code> which is the name of the FITS extension of <code>hdu</code>, that is <code>&quot;IMAGE&quot;</code>, <code>&quot;TABLE&quot;</code>, <code>&quot;BINTABLE&quot;</code>, or <code>&quot;ANY&quot;</code> depending on whether <code>hdu</code> is an image, an ASCII table, a binary table, or anything else.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L460-L469">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EasyFITS.is_named" href="#EasyFITS.is_named"><code>EasyFITS.is_named</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EasyFITS.is_named(hdu, pat) -&gt; bool</code></pre><p>yields whether pattern <code>pat</code> is equal to (in the FITS sense if <code>pat</code> is a string) or matches (if <code>pat</code> is a regular expression) the extension of the FITS header data unit <code>hdu</code>, or to the value of one of its <code>&quot;EXTNAME&quot;</code> or <code>&quot;HDUNAME&quot;</code> keywords. These are respectively given by <code>hdu.xtension</code>, <code>hdu.extname</code>, or <code>hdu.hduname</code>.</p><p>This method is used as a predicate for the search methods <code>findfirst</code>, <code>findlast</code>, <code>findnext</code>, and <code>findprev</code>.</p><p>The extension <code>hdu.xtension</code> is <code>&quot;IMAGE&quot;</code>, <code>&quot;TABLE&quot;</code>, <code>&quot;BINTABLE&quot;</code>, or <code>&quot;ANY&quot;</code> depending on whether <code>hdu</code> is an image, an ASCII table, a binary table, or anything else.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L478-L492">source</a></section><section><div><pre><code class="language-julia hljs">EasyFITS.is_named(pat) -&gt; pred</code></pre><p>yields e predicate function <code>pred</code> that can be used to check whether pattern <code>pat</code> is equal to (in the FITS sense if <code>pat</code> is a string) or matches (if <code>pat</code> is a regular expression) the extension of the FITS header data units (HDUs).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/files.jl#L498-L505">source</a></section></article><h2 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EasyFITS.OutputCstring" href="#EasyFITS.OutputCstring"><code>EasyFITS.OutputCstring</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">s = EasyFITS.OutputCstring(len)</code></pre><p>Build an object that can be used as an output C string with at most <code>len</code> characters. This object can be passed to a C function where an output string is expected via a <code>ccall</code> as an argument of type <code>Cstring</code>. On return of the C function, the object can be safely converted to a Julia string by calling <code>String(s)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/utils.jl#L2-L10">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="EasyFITS.cfitsio_errmsg" href="#EasyFITS.cfitsio_errmsg"><code>EasyFITS.cfitsio_errmsg</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EasyFITS.cfitsio_errmsg(status) -&gt; msg::String</code></pre><p>Return the error message corresponding to CFITSIO <code>status</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/utils.jl#L41-L46">source</a></section><section><div><pre><code class="language-julia hljs">EasyFITS.cfitsio_errmsg() -&gt; msg::Union{String,Nothing}</code></pre><p>Read the oldest CFITSIO error message and discard it. <code>nothing</code> is returned if there are no error messages left.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/emmt/EasyFITS.jl/blob/00196786bd2691682553afa8cee8d07adb1398b4/src/utils.jl#L53-L59">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tables/">« FITS Table HDUs</a><a class="docs-footer-nextpage" href="../links/">Index »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 16 October 2025 13:41">Thursday 16 October 2025</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
