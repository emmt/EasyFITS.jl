<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Writing FITS files · Easy access to FITS files in Julia</title><meta name="title" content="Writing FITS files · Easy access to FITS files in Julia"/><meta property="og:title" content="Writing FITS files · Easy access to FITS files in Julia"/><meta property="twitter:title" content="Writing FITS files · Easy access to FITS files in Julia"/><meta name="description" content="Documentation for Easy access to FITS files in Julia."/><meta property="og:description" content="Documentation for Easy access to FITS files in Julia."/><meta property="twitter:description" content="Documentation for Easy access to FITS files in Julia."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Easy access to FITS files in Julia</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../structure/">Structure of FITS files</a></li><li><a class="tocitem" href="../reading/">Reading FITS files</a></li><li class="is-active"><a class="tocitem" href>Writing FITS files</a><ul class="internal"><li><a class="tocitem" href="#Direct-writing-of-a-FITS-file"><span>Direct writing of a FITS file</span></a></li><li><a class="tocitem" href="#Advanced-writing-of-a-FITS-file"><span>Advanced writing of a FITS file</span></a></li></ul></li><li><a class="tocitem" href="../files/">Navigating in FITS files</a></li><li><a class="tocitem" href="../images/">FITS Image HDUs</a></li><li><a class="tocitem" href="../tables/">FITS Table HDUs</a></li><li><a class="tocitem" href="../library/">Reference</a></li><li><a class="tocitem" href="../links/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Writing FITS files</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Writing FITS files</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/emmt/EasyFITS.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/emmt/EasyFITS.jl/blob/master/docs/src/writing.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Writing-FITS-files"><a class="docs-heading-anchor" href="#Writing-FITS-files">Writing FITS files</a><a id="Writing-FITS-files-1"></a><a class="docs-heading-anchor-permalink" href="#Writing-FITS-files" title="Permalink"></a></h1><p>This section explains how to directly write a FITS file in a single function call whose arguments readily reflects the structure of the FITS file or how to create and write the contents of a FITS file <em>piece-by-piece</em>.</p><h2 id="Direct-writing-of-a-FITS-file"><a class="docs-heading-anchor" href="#Direct-writing-of-a-FITS-file">Direct writing of a FITS file</a><a id="Direct-writing-of-a-FITS-file-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-writing-of-a-FITS-file" title="Permalink"></a></h2><p>A complex (i.e. with multiple HDUs) FITS file may be directly written in a single call to <a href="../library/#EasyFITS.writefits"><code>writefits</code></a> or <a href="../library/#EasyFITS.writefits!"><code>writefits!</code></a> as:</p><pre><code class="language-julia hljs">writefits(filename, hdr1, dat1, hdr2, dat2, ...; kwds...)</code></pre><p>where <code>filename</code> is the name of the FITS file, <code>hdr1</code> and <code>dat1</code> specify the header and data parts of the first HDU, <code>hdr2</code> and <code>dat2</code> specify the header and data parts of the second HDU and so on. Here <code>kwds...</code> represent keywords that are passed to <a href="../library/#EasyFITS.FitsFile"><code>FitsFile</code></a>. The call <code>writefits!(args...; kwds...)</code> is a shortcut for <code>writefits(args...; overwrite = true, kwds...)</code> which overwrites <code>filename</code> if it already exists.</p><p>In <code>EasyFITS</code>, there are many different possible ways to specify a HDU header and data:</p><ul><li><p>A header may be <code>nothing</code> if there are no additional keywords other than the <em>structural keywords</em> describing the data part. Otherwise, the possible types for a header are given by the union <a href="../library/#EasyFITS.Header"><code>EasyFITS.Header</code></a>: a header may be a collection of <code>FitsCard</code> instances (i.e. an instance of <code>FitsHeader</code>, a tuple, or a vector of FITS cards), a named tuple, a tuple or a vector of pairs like <code>key =&gt; val</code> or <code>key =&gt; (val, com)</code> with <code>key</code> the keyword name, <code>val</code> its value, and <code>com</code> a comment.</p></li><li><p>For a FITS Image HDU, the data part is specified as a numerical Julia array.</p></li><li><p>For a FITS Table HDU, the data part may be specified by a dictionary (whose keys are the column names and whose values are the corresponding column data), a vector of column data, a named tuple, a tuple or a vector of pairs like <code>col =&gt; val</code> with <code>col</code> the column name and <code>val</code> the column data. The data of each column of a table is a Julia array, the number of rows of the table is the last dimension of these arrays which must be the same for all columns.</p></li></ul><p>Calling <a href="../library/#EasyFITS.writefits"><code>writefits</code></a> or <a href="../library/#EasyFITS.writefits!"><code>writefits!</code></a>, the structure of the resulting FITS file can be made obvious by the code as in the following complex example with array <code>arr</code> saved in the primary HDU and two tables in the next HDUs:</p><pre><code class="language-julia hljs">using Dates, EasyFITS
filename = &quot;/tmp/test.fits&quot;;
arr = rand(Float32, (3,4,5));
nrows = 20;
inds = 1:nrows;
speed = rand(Float64, nrows);
mass = rand(Float32, nrows);
position = rand(Float32, 3, nrows);
phase = (1:7) .// 3;
amplitude = exp.(-1:-1:-7);
x = amplitude.*cos.(phase);
y = amplitude.*sin.(phase);
writefits(filename,
          #-----------------------------------------------------------------
          # First HDU must be a FITS &quot;image&quot;, but data may be empty.
          #
          # Header part as a vector of `key=&gt;val` or `key=&gt;(val,com)` pairs:
          [&quot;DATE&quot;    =&gt; (now(), &quot;date of creation&quot;),
           &quot;HISTORY&quot; =&gt; &quot;This file has been produced by EasyFITS&quot;,
           &quot;USER&quot;    =&gt; ENV[&quot;USER&quot;]],
          # Data part as an array:
          arr,
          #-----------------------------------------------------------------
          # Second HDU, here a FITS &quot;table&quot;.
          #
          # Header part of 2nd HDU as a tuple of pairs:
          (&quot;EXTNAME&quot; =&gt; (&quot;MY-EXTENSION&quot;, &quot;Name of this extension&quot;),
           &quot;EXTVER&quot;  =&gt; (1, &quot;Version of this extension&quot;)),
          # Data part is a table in the form of a named tuple:
          (Speed    = (speed, &quot;km/s&quot;),  # this column has units
           Indices  = inds,             # not this one
           Mass     = (mass, &quot;kg&quot;),
           Position = (position, &quot;cm&quot;)),
          #-----------------------------------------------------------------
          # Third HDU, another FITS &quot;table&quot;.
          #
          # Header part of 3rd HDU as a named tuple (note that keywords must
          # be in uppercase letters):
          (EXTNAME = (&quot;MY-OTHER-EXTENSION&quot;, &quot;Name of this other extension&quot;),
           EXTVER  = (1, &quot;Version of this other extension&quot;),
           COMMENT = &quot;This is an interesting comment&quot;),
          # Data part is a table in the form of a vector of pairs (column names
          # can be strings or symbols but not a mixture):
          [:phase =&gt; ((180/π).*phase, &quot;deg&quot;),
           :amplitude =&gt; (amplitude, &quot;V&quot;),
           :xy =&gt; (hcat(x,y)&#39;, &quot;V&quot;)])</code></pre><h2 id="Advanced-writing-of-a-FITS-file"><a class="docs-heading-anchor" href="#Advanced-writing-of-a-FITS-file">Advanced writing of a FITS file</a><a id="Advanced-writing-of-a-FITS-file-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-writing-of-a-FITS-file" title="Permalink"></a></h2><p>Direct writing of a FITS file with <a href="../library/#EasyFITS.writefits"><code>writefits</code></a> or <a href="../library/#EasyFITS.writefits!"><code>writefits!</code></a> is designed to write all the content of a FITS file in a single function call and with a syntax that readily shows the structure of the file. This is not suitable when not all content is immediately available or when it is more convenient to write the FITS file piece by piece. The latter is typically done by the following steps:</p><ol><li><p>Create a new empty FITS file for writing with the <a href="../library/#EasyFITS.FitsFile"><code>FitsFile</code></a> constructor.</p></li><li><p>Append a new HDU to with the <a href="../library/#EasyFITS.FitsImageHDU"><code>FitsImageHDU</code></a> constructor or the <a href="../library/#EasyFITS.FitsTableHDU"><code>FitsTableHDU</code></a> constructor.</p></li><li><p>Instantiate the FITS keywords of the header part of the HDU.</p></li><li><p>Write the data part of the HDU. This may be done by chunks and this depend on whether the HDU is an image or a table.</p></li><li><p>Eventually close the FITS file with <code>close</code>. Closing the FITS file is automatically done when the object representing the file is no longer used and garbage collected, closing the file is therefore optional.</p></li></ol><p>Remarks:</p><ul><li>Steps 2 to 4 can be repeated as many times as necessary to create more than one HDU.</li></ul><p>For example, with <code>arr</code> a Julia array to be written in the data part of the HDU:</p><pre><code class="language-julia hljs"># Create the file:
file = FitsFile(filename, &quot;w&quot;)
# Appends a new HDU to store array data `arr`:
hdu = FitsImageHDU(file, arr)
# Set some keywords in the header part of the HDU:
hdu[&quot;HDUNAME&quot;] = (&quot;SOME_NAME&quot;, &quot;Name of this HDU&quot;)
hdu[&quot;COMMENT&quot;] = &quot;Some comment.&quot;
# Write the data part of the HDU:
write(hdu, arr)
# Close the file:
close(file)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../reading/">« Reading FITS files</a><a class="docs-footer-nextpage" href="../files/">Navigating in FITS files »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 16 October 2025 13:41">Thursday 16 October 2025</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
