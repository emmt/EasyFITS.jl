# Build Julia wrapper code for `CFITSIO_jll`

## Rationale

`EasyFITS` relies on code in `CFITSIO.jl` to call the C functions of the CFITSIO library.
This code is automatically generated by the script `make.jl` in this directory. This script
uses [`Clang.jl`](https://github.com/JuliaInterop/Clang.jl) to parse the header files of the
CFITSIO library plus some post-processing for fixing things and cleanup.

To avoid re-building `CFITSIO.jl` every time, this file is stored in the `../src` directory
and shipped with the `EasyFITS` package. The compatibility settings for the artifact
`CFITSIO_jll` should be set so as to avoid using a `CFITSIO.jl` generated for a version of
the CFITSIO library that has a different API.

When it is loaded (by `using` or `import`), the `EasyFITS` package checks whether the API of
the CFITSIO library may have changed assuming the rules of [Semantic
Versioning](https://semver.org). According to these rules, the wrapper code is compatible
with the library if they have the same major version number and if the library has a minor
version number greater or equal than that of the wrapper code. If this does not hold, a
warning is printed to ask for regenerating the wrapper code as explained below.


## Rebuild the wrapper code

Simply execute:

``` julia
cd EasyFITS.jl/gen # go to the directory where is the code generator
julia --project=. -e 'using Pkg; Pkg.instantiate(); include("make.jl");'
```

Then compare the file ``CFITSIO.jl` with the one in `../src`. If there are significant
differences, then:

1. replace the version in `../src` by the new wrapper code,

2. update the `[compat]` entry in `EasyFITS.jl` project file [`../Project.toml`](../Project.toml),

3. run the tests,

4. commit the changes,

5. register a new version.
